consider moving hasing to typeorm